<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Snap! Build Your Own Blocks. Beta</title>
        <link rel="shortcut icon" href="http://snap.berkeley.edu/fav3.gif" type="image/gif">
		<script type="text/javascript" src="morphic.js"></script>
		<script type="text/javascript" src="widgets.js"></script>
		<script type="text/javascript" src="blocks.js"></script>
		<script type="text/javascript" src="threads.js"></script>
		<script type="text/javascript" src="objects.js"></script>
		<script type="text/javascript" src="gui.js"></script>
		<script type="text/javascript" src="lists.js"></script>
		<script type="text/javascript" src="byob.js"></script>
		<script type="text/javascript" src="xml.js"></script>
		<script type="text/javascript" src="store.js"></script>
		<script type="text/javascript" src="locale.js"></script>
		<script type="text/javascript" src="cloud.js"></script>
		<script type="text/javascript" src="sha512.js"></script>
		<script type="text/javascript">			
			var world;
			window.onload = function () {
				world = new WorldMorph(document.getElementById('world'));
				new IDE_Morph().openIn(world);
				setInterval(loop, 1);

				// KAMKO: the following code would open a "Edit block" dialog on starting snap, but I haven't figured out how to implement it properly yet.

				/* findFactorial = function() {
					var blocks = stage.globalBlocks
					var len = blocks.length
					for (var i = 0; i < len; i++) {
						if (blocks[i].spec == "factorial of %'x'")
							return i;
					}
					return null;
				}

				var myself = world;		
				var ide = myself.children[0];
				var stage = ide.stage;
				var factorial = stage.globalBlocks[findFactorial()]
				if (factorial != null) {
					new BlockEditorMorph(factorial, factorial.receiver).popUp();
				} */
				
				
				// KAMKO: The following code would open a "make new block" dialog on starting snap

				/* new BlockDialogMorph(
                    null,
                    function (definition) {
                        if (definition.spec !== '') {
                            if (definition.isGlobal) {
                                stage.globalBlocks.push(definition);
                            } else {
                                obj.customBlocks.push(definition);
                            }
                            ide.flushPaletteCache();
                            ide.refreshPalette();
                            new BlockEditorMorph(definition, obj).popUp();
                        }
                    },
                    myself
                ).prompt(
                    'Make a block',
                    null,
                    myself.world()
                ) */

            };

			function loop() {
				world.doOneCycle();

			}
                        
		</script>
	</head>
	<body style="background-color: #282828; margin: 0;">
		<canvas id="world" tabindex="1" width="800" height="600" style="position: absolute;">
			<p>Your browser doesn't support canvas.</p>
		</canvas>
    </body>
</html>
